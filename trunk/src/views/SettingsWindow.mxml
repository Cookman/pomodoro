<?xml version="1.0"?>
<!--
  Created by Cookman on 03.12.2014.
-->
<s:Window xmlns:fx="http://ns.adobe.com/mxml/2009" xmlns:s="library://ns.adobe.com/flex/spark"
          xmlns:mx="library://ns.adobe.com/flex/mx" resizable="false"
          width="250" height="150" showStatusBar="false" isPopUp="true" alwaysInFront="true" title="Settings" maximizable="false"
          minimizable="false" type="{NativeWindowType.UTILITY}"
          creationComplete="creationCompleteHandler(event)">
    <fx:Script><![CDATA[
        import models.LocalStorage;
        import models.MindTimerModel;

        import vo.SettingsVO;

        private var settings:SettingsVO;
        private var model:MindTimerModel = MindTimerModel.getInstance();

        protected function creationCompleteHandler(event:Event):void {
            settings = model.settings;
            if (settings) {
                usePomLength.selected = settings.useFixedPomodoroLength;
                countPoms.selected = settings.showPomodoroStatistic;
                pomodoroLength.text = settings.pomodoroLength.toString();
            }
        }

        protected function okHandler(event:Event):void {
            if (settings) {
                settings.useFixedPomodoroLength = usePomLength.selected;
                settings.pomodoroLength = parseInt(pomodoroLength.text);
                settings.showPomodoroStatistic = countPoms.selected;
                LocalStorage.saveSettings(settings);
                model.trayIt.show();
                this.close();
            }
        }

        protected function cancelHandler(event:Event):void {
            model.trayIt.show();
            this.close();
        }
        ]]></fx:Script>
    <s:VGroup width="100%" height="100%">
        <mx:TabNavigator width="100%" height="100%">
            <mx:VBox width="100%" height="100%" label="Poms">
                <s:CheckBox id="countPoms" label="Count poms"></s:CheckBox>
                <mx:HBox width="100%" height="100%">
                    <s:CheckBox id="usePomLength" label="Use pom length"></s:CheckBox>
                    <s:TextInput id="pomodoroLength" enabled="{usePomLength.selected}" text="25" width="40"
                                 restrict="0-9"/>
                </mx:HBox>
            </mx:VBox>
        </mx:TabNavigator>
        <s:HGroup>
            <mx:Button click="okHandler(event)" label="OK"/>
            <mx:Button click="cancelHandler(event)" label="Cancel"/>
        </s:HGroup>
    </s:VGroup>
</s:Window>